<html>

<head>
<title>LD31</title>

<link rel="stylesheet" href="style.css" type="text/css" />

<!-- Included 3rd party libraries -->
<script type="text/javascript" src="libraries/jsbox2d.js"></script>

<!-- Render and Game code in here -->

<script type="text/javascript" src="renderer.js"></script>
<script type="text/javascript" src="camera.js"></script>
<script type="text/javascript" src="tile.js"></script>
<script type="text/javascript" src="entity.js"></script>
<script type="text/javascript" src="world.js"></script>
<script type="text/javascript" src="game.js"></script>



<script type="text/javascript">

//// Contains the main wrapper functions to interact with HTML5, and Init functions

var renderer; //gloabal ref
var last_time; // timestamp of last frame to calculate delta

var game;

function Init()
{
	renderer = new Renderer(32*32, 32*20, "canvas");

	document.getElementById("loading").style.display = "none";


	var tileimg = document.getElementById("tiles");
	var entimg = tileimg;

	game = new Game(renderer, tileimg, entimg);


	document.addEventListener('keydown', Game_KeyDown, false);
	document.addEventListener('keyup', Game_KeyUp, false);

	requestAnimationFrame(Step);
}


function Game_KeyDown(e)
{
	var char = String.fromCharCode(e.keyCode || e.charCode);
	game.Key(e, char, true);
}


function Game_KeyUp(e)
{
	var char = String.fromCharCode(e.keyCode || e.charCode);
	game.Key(e, char, false);
}


function Update(dt)
{
	game.Update(dt);
}


function Render()
{

	renderer.SetFill("black");
	renderer.Fill();

	game.Render();

}


function Step(timestamp)
{
	if (! last_time)
	{
		last_time = timestamp;
	}
	var delta_time = (timestamp - last_time) / 1000.0;
	last_time = timestamp;

	Update(delta_time);

	Render();


	requestAnimationFrame(Step);
}


</script>

</head>

<body onLoad="Init();">

<h1>Ludum Dare 31 : Entire game on one screen</h1>

<div id="instructions">
<h2>Instructions:</h2>
<li>WASD: Move</li>
<li>Press Reload/F5 to restart</li>
<li>Currently not much else :/</li>
</div>

<div id="loading"> 
<h1>Loading... </h1>
<img src="ProgrammerArt/tiles.png" id="tiles"/>
</div>

<canvas id="canvas"></canvas>

<hr/>

By Lasty.
- <a href="https://twitter.com/tristan_lasty">@tristan_lasty</a>
- <a href="https://twitter.com/hashtag/LDJAM?src=hash">#LDJAM</a>

<br/>
Github:  <a href="https://github.com/lasty/ld31_onescreen">https://github.com/lasty/ld31_onescreen</a>
<br/>

<br/>
Notes:
<li> May take a while to load first time around.</li>
<li> May not work properly on Internet Explorer.  Use Chrome or Firefox if you have problems. </li>

</body>

</html>
